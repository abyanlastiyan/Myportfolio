<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Sensor Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #64748b;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        
        .card {
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        }
        
        .sensor-value {
            font-size: 2.5rem;
            font-weight: 700;
            transition: color 0.5s ease;
        }
        
        .alert-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .toggle-checkbox:checked {
            right: 0;
            border-color: var(--primary);
            background-color: var(--primary);
        }
        
        .toggle-checkbox:checked + .toggle-label {
            background-color: var(--primary);
        }
        
        .gauge {
            --percentage: 0;
            --fill-color: var(--primary);
            position: relative;
            width: 100%;
            height: 120px;
        }
        
        .gauge-body {
            width: 100%;
            height: 0;
            padding-bottom: 50%;
            position: relative;
            border-top-left-radius: 100% 200%;
            border-top-right-radius: 100% 200%;
            overflow: hidden;
            background-color: #e2e8f0;
        }
        
        .gauge-fill {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--fill-color);
            transform-origin: center top;
            transform: rotate(0.5turn);
            transition: transform 0.5s ease-out, background-color 0.5s;
        }
        
        .gauge-cover {
            width: 75%;
            height: 150%;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 25%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 0 5px rgba(0,0,0,0.2) inset;
        }
        
        .data-updated {
            animation: highlight 1s;
        }
        
        @keyframes highlight {
            0% { background-color: rgba(59, 130, 246, 0.3); }
            100% { background-color: transparent; }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-8">
            <div class="flex items-center mb-4 md:mb-0">
                <div class="w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center mr-3">
                    <i class="fas fa-microchip text-white text-xl"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800">IoT Sensor Dashboard</h1>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <button id="settings-btn" class="flex items-center space-x-2 bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 hover:bg-gray-50">
                        <i class="fas fa-cog text-gray-500"></i>
                        <span class="hidden md:inline text-gray-600">Settings</span>
                    </button>
                    <div id="settings-dropdown" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-md shadow-lg z-10 border border-gray-200">
                        <div class="p-4">
                            <h3 class="font-medium text-gray-700 mb-2">MQTT Configuration</h3>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Broker URL</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md" value="mqtt://broker.example.com">
                                </div>
                                <div>
                                    <label class="block text-sm text-gray-600 mb-1">Topic Prefix</label>
                                    <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md" value="iot/device123/">
                                </div>
                                <button class="w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition">Save Settings</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-2">
                    <div class="w-2 h-2 rounded-full bg-green-500"></div>
                    <span class="text-sm text-gray-600">Connected</span>
                </div>
            </div>
        </header>
        
        <!-- Main Dashboard Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Ultrasonic Sensor Card -->
            <div class="card bg-white rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">Distance Sensor</h2>
                        <p class="text-sm text-gray-500">Ultrasonic HC-SR04</p>
                    </div>
                    <div class="flex items-center">
                        <span class="text-xs font-medium px-2 py-1 rounded-full" id="distance-status" style="background-color: #dbeafe; color: #1d4ed8;">Normal</span>
                    </div>
                </div>
                
                <div class="flex items-end justify-between">
                    <div>
                        <div class="sensor-value text-blue-500 mb-1" id="distance-value">--</div>
                        <div class="text-sm text-gray-500">Current distance</div>
                    </div>
                    <div class="gauge mb-2">
                        <div class="gauge-body">
                            <div class="gauge-fill" id="distance-gauge"></div>
                            <div class="gauge-cover" id="distance-percentage">0%</div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <div class="flex justify-between text-sm">
                        <div>
                            <span class="text-gray-500">Min:</span>
                            <span class="font-medium ml-1" id="distance-min">0 cm</span>
                        </div>
                        <div>
                            <span class="text-gray-500">Max:</span>
                            <span class="font-medium ml-1" id="distance-max">400 cm</span>
                        </div>
                        <div>
                            <span class="text-gray-500">Threshold:</span>
                            <span class="font-medium ml-1" id="distance-threshold">50 cm</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- MPU6050 Sensor Card -->
            <div class="card bg-white rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">Motion Sensor</h2>
                        <p class="text-sm text-gray-500">MPU6050 Accelerometer</p>
                    </div>
                    <div class="flex items-center">
                        <span class="text-xs font-medium px-2 py-1 rounded-full" id="mpu-status" style="background-color: #fef3c7; color: #92400e;">Warning</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-3 gap-4">
                    <div class="text-center">
                        <div class="sensor-value text-amber-500 mb-1" id="mpu-x-value">--</div>
                        <div class="text-sm text-gray-500">X-axis</div>
                    </div>
                    <div class="text-center">
                        <div class="sensor-value text-amber-500 mb-1" id="mpu-y-value">--</div>
                        <div class="text-sm text-gray-500">Y-axis</div>
                    </div>
                    <div class="text-center">
                        <div class="sensor-value text-amber-500 mb-1" id="mpu-z-value">--</div>
                        <div class="text-sm text-gray-500">Z-axis</div>
                    </div>
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <span class="text-sm text-gray-500">Tilt Angle:</span>
                            <span class="font-medium ml-1" id="tilt-angle">0°</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-sm text-gray-500 mr-2">Alert:</span>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" value="" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Battery Voltage Card -->
            <div class="card bg-white rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">Power Status</h2>
                        <p class="text-sm text-gray-500">Battery Voltage</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-battery-three-quarters text-green-500 text-xl"></i>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <div>
                        <div class="sensor-value text-green-500 mb-1" id="voltage-value">--</div>
                        <div class="text-sm text-gray-500">Current voltage</div>
                    </div>
                    <div class="w-24">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-green-500 rounded-full" id="voltage-bar" style="width: 75%"></div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>9V</span>
                            <span>12.6V</span>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-sm text-gray-500">Status:</span>
                            <span class="font-medium ml-1 text-green-500" id="battery-status">Charging</span>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Remaining:</span>
                            <span class="font-medium ml-1" id="battery-remaining">~4h 30m</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Relay Control Card -->
            <div class="card bg-white rounded-xl p-6 md:col-span-2">
                <div class="flex justify-between items-center mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">Relay Controls</h2>
                        <p class="text-sm text-gray-500">Toggle connected devices</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button id="all-on" class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded hover:bg-blue-200">All ON</button>
                        <button id="all-off" class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded hover:bg-gray-200">All OFF</button>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <!-- Relay 1 -->
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="flex justify-center mb-3">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-lightbulb text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <h3 class="font-medium text-gray-700 mb-2">Light 1</h3>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" data-relay="1">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    
                    <!-- Relay 2 -->
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="flex justify-center mb-3">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-fan text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <h3 class="font-medium text-gray-700 mb-2">Fan</h3>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" data-relay="2">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    
                    <!-- Relay 3 -->
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="flex justify-center mb-3">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-plug text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <h3 class="font-medium text-gray-700 mb-2">Outlet</h3>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" data-relay="3">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                    
                    <!-- Relay 4 -->
                    <div class="bg-gray-50 p-4 rounded-lg text-center">
                        <div class="flex justify-center mb-3">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-lightbulb text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <h3 class="font-medium text-gray-700 mb-2">Light 2</h3>
                        <label class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only peer" data-relay="4">
                            <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-500"></div>
                        </label>
                    </div>
                </div>
            </div>
            
            <!-- GPS Location Card -->
            <div class="card bg-white rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">GPS Location</h2>
                        <p class="text-sm text-gray-500">Current device position</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-satellite text-blue-500"></i>
                    </div>
                </div>
                
                <div class="flex items-center mb-4">
                    <div class="mr-3">
                        <i class="fas fa-map-marker-alt text-red-500 text-xl"></i>
                    </div>
                    <div>
                        <div class="font-medium" id="gps-coords">34.0522° N, 118.2437° W</div>
                        <div class="text-sm text-gray-500" id="gps-address">Los Angeles, California</div>
                    </div>
                </div>
                
                <div id="map-container" class="h-48 bg-gray-200 rounded-lg overflow-hidden relative">
                    <div id="map" class="h-full w-full"></div>
                    <div class="absolute bottom-2 right-2 bg-white px-2 py-1 rounded shadow text-xs">
                        <span id="gps-accuracy">Accuracy: 5m</span>
                    </div>
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <div class="flex justify-between text-sm">
                        <div>
                            <span class="text-gray-500">Last update:</span>
                            <span class="font-medium ml-1" id="gps-updated">2 seconds ago</span>
                        </div>
                        <div>
                            <span class="text-gray-500">Speed:</span>
                            <span class="font-medium ml-1" id="gps-speed">0 km/h</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- System Status Card -->
            <div class="card bg-white rounded-xl p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-800">System Status</h2>
                        <p class="text-sm text-gray-500">Device connectivity & health</p>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-shield-alt text-blue-500"></i>
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3">
                                <i class="fas fa-wifi text-green-500"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-700">WiFi Connection</div>
                                <div class="text-xs text-gray-500">Connected to HomeNetwork</div>
                            </div>
                        </div>
                        <span class="text-sm font-medium text-green-500">Strong</span>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                                <i class="fas fa-cloud text-blue-500"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-700">MQTT Broker</div>
                                <div class="text-xs text-gray-500">broker.example.com</div>
                            </div>
                        </div>
                        <span class="text-sm font-medium text-green-500">Connected</span>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-amber-100 flex items-center justify-center mr-3">
                                <i class="fas fa-microchip text-amber-500"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-700">CPU Usage</div>
                                <div class="text-xs text-gray-500">ESP32</div>
                            </div>
                        </div>
                        <span class="text-sm font-medium text-amber-500">42%</span>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3">
                                <i class="fas fa-memory text-blue-500"></i>
                            </div>
                            <div>
                                <div class="font-medium text-gray-700">Memory</div>
                                <div class="text-xs text-gray-500">Free heap</div>
                            </div>
                        </div>
                        <span class="text-sm font-medium text-blue-500">124KB</span>
                    </div>
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-100">
                    <div class="flex justify-between items-center">
                        <div>
                            <span class="text-sm text-gray-500">Uptime:</span>
                            <span class="font-medium ml-1" id="uptime">2d 4h 36m</span>
                        </div>
                        <button class="text-sm text-blue-500 hover:text-blue-600">View Logs</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="mt-8 pt-6 border-t border-gray-200">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-sm text-gray-500 mb-4 md:mb-0">
                    © 2023 IoT Sensor Dashboard. All rights reserved.
                </div>
                <div class="flex space-x-4">
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fab fa-github"></i>
                    </button>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-question-circle"></i>
                    </button>
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell"></i>
                    </button>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Initialize Google Maps
        function initMap() {
            const losAngeles = { lat: 34.0522, lng: -118.2437 };
            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 12,
                center: losAngeles,
                styles: [
                    {
                        featureType: "all",
                        elementType: "labels.text.fill",
                        stylers: [
                            { saturation: 36 },
                            { color: "#333333" },
                            { lightness: 40 }
                        ]
                    },
                    {
                        featureType: "all",
                        elementType: "labels.text.stroke",
                        stylers: [
                            { visibility: "on" },
                            { color: "#ffffff" },
                            { lightness: 16 }
                        ]
                    },
                    {
                        featureType: "all",
                        elementType: "labels.icon",
                        stylers: [{ visibility: "off" }]
                    },
                    {
                        featureType: "administrative",
                        elementType: "geometry.fill",
                        stylers: [{ color: "#fefefe" }, { lightness: 20 }]
                    },
                    {
                        featureType: "administrative",
                        elementType: "geometry.stroke",
                        stylers: [{ color: "#fefefe" }, { lightness: 17 }, { weight: 1.2 }]
                    },
                    {
                        featureType: "landscape",
                        elementType: "geometry",
                        stylers: [{ color: "#f5f5f5" }, { lightness: 20 }]
                    },
                    {
                        featureType: "poi",
                        elementType: "geometry",
                        stylers: [{ color: "#f5f5f5" }, { lightness: 21 }]
                    },
                    {
                        featureType: "poi.park",
                        elementType: "geometry",
                        stylers: [{ color: "#dedede" }, { lightness: 21 }]
                    },
                    {
                        featureType: "road.highway",
                        elementType: "geometry.fill",
                        stylers: [{ color: "#ffffff" }, { lightness: 17 }]
                    },
                    {
                        featureType: "road.highway",
                        elementType: "geometry.stroke",
                        stylers: [{ color: "#ffffff" }, { lightness: 29 }, { weight: 0.2 }]
                    },
                    {
                        featureType: "road.arterial",
                        elementType: "geometry",
                        stylers: [{ color: "#ffffff" }, { lightness: 18 }]
                    },
                    {
                        featureType: "road.local",
                        elementType: "geometry",
                        stylers: [{ color: "#ffffff" }, { lightness: 16 }]
                    },
                    {
                        featureType: "transit",
                        elementType: "geometry",
                        stylers: [{ color: "#f2f2f2" }, { lightness: 19 }]
                    },
                    {
                        featureType: "water",
                        elementType: "geometry",
                        stylers: [{ color: "#e9e9e9" }, { lightness: 17 }]
                    }
                ]
            });
            
            const marker = new google.maps.Marker({
                position: losAngeles,
                map: map,
                icon: {
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: 8,
                    fillColor: "#4285F4",
                    fillOpacity: 1,
                    strokeWeight: 2,
                    strokeColor: "#ffffff"
                }
            });
            
            window.map = map;
            window.marker = marker;
        }
        
        // Toggle settings dropdown
        document.getElementById('settings-btn').addEventListener('click', function() {
            const dropdown = document.getElementById('settings-dropdown');
            dropdown.classList.toggle('hidden');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const settingsBtn = document.getElementById('settings-btn');
            const dropdown = document.getElementById('settings-dropdown');
            
            if (!settingsBtn.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.classList.add('hidden');
            }
        });
        
        // Relay controls
        document.querySelectorAll('[data-relay]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const relayNum = this.getAttribute('data-relay');
                const isOn = this.checked;
                console.log(`Relay ${relayNum} turned ${isOn ? 'ON' : 'OFF'}`);
                
                // Here you would send MQTT message to control the relay
                // mqttPublish(`iot/device123/relay/${relayNum}`, isOn ? '1' : '0');
            });
        });
        
        // All ON/OFF buttons
        document.getElementById('all-on').addEventListener('click', function() {
            document.querySelectorAll('[data-relay]').forEach(checkbox => {
                checkbox.checked = true;
                const relayNum = checkbox.getAttribute('data-relay');
                console.log(`Relay ${relayNum} turned ON`);
                // mqttPublish(`iot/device123/relay/${relayNum}`, '1');
            });
        });
        
        document.getElementById('all-off').addEventListener('click', function() {
            document.querySelectorAll('[data-relay]').forEach(checkbox => {
                checkbox.checked = false;
                const relayNum = checkbox.getAttribute('data-relay');
                console.log(`Relay ${relayNum} turned OFF`);
                // mqttPublish(`iot/device123/relay/${relayNum}`, '0');
            });
        });
        
        // Simulate real-time data updates
        function simulateDataUpdates() {
            // Ultrasonic sensor
            const distance = Math.floor(Math.random() * 400);
            updateSensorValue('distance-value', `${distance} cm`, '#3b82f6');
            
            // Update gauge
            const distancePercentage = Math.min(100, Math.floor((distance / 400) * 100));
            document.getElementById('distance-percentage').textContent = `${distancePercentage}%`;
            document.getElementById('distance-gauge').style.transform = `rotate(${0.5 + (distancePercentage / 100)}turn)`;
            
            // Update status
            if (distance < 30) {
                document.getElementById('distance-status').textContent = 'Close';
                document.getElementById('distance-status').style.backgroundColor = '#fee2e2';
                document.getElementById('distance-status').style.color = '#b91c1c';
            } else {
                document.getElementById('distance-status').textContent = 'Normal';
                document.getElementById('distance-status').style.backgroundColor = '#dbeafe';
                document.getElementById('distance-status').style.color = '#1d4ed8';
            }
            
            // MPU6050 sensor
            const xVal = (Math.random() * 20 - 10).toFixed(2);
            const yVal = (Math.random() * 20 - 10).toFixed(2);
            const zVal = (Math.random() * 20 - 10).toFixed(2);
            
            updateSensorValue('mpu-x-value', xVal, '#f59e0b');
            updateSensorValue('mpu-y-value', yVal, '#f59e0b');
            updateSensorValue('mpu-z-value', zVal, '#f59e0b');
            
            // Calculate tilt angle
            const tiltAngle = Math.floor(Math.sqrt(xVal*xVal + yVal*yVal + zVal*zVal));
            document.getElementById('tilt-angle').textContent = `${tiltAngle}°`;
            
            // Update status
            if (tiltAngle > 15) {
                document.getElementById('mpu-status').textContent = 'Tilt Alert';
                document.getElementById('mpu-status').style.backgroundColor = '#fef3c7';
                document.getElementById('mpu-status').style.color = '#92400e';
            } else {
                document.getElementById('mpu-status').textContent = 'Stable';
                document.getElementById('mpu-status').style.backgroundColor = '#ecfdf5';
                document.getElementById('mpu-status').style.color = '#065f46';
            }
            
            // Battery voltage
            const voltage = (Math.random() * 3.6 + 9).toFixed(2);
            updateSensorValue('voltage-value', `${voltage} V`, '#10b981');
            
            // Update battery bar
            const voltagePercentage = Math.min(100, Math.floor(((voltage - 9) / 3.6) * 100));
            document.getElementById('voltage-bar').style.width = `${voltagePercentage}%`;
            
            // Update battery status
            if (voltagePercentage < 20) {
                document.getElementById('battery-status').textContent = 'Low';
                document.getElementById('battery-status').className = 'font-medium ml-1 text-red-500';
                document.getElementById('voltage-bar').style.backgroundColor = '#ef4444';
            } else if (voltagePercentage < 60) {
                document.getElementById('battery-status').textContent = 'Medium';
                document.getElementById('battery-status').className = 'font-medium ml-1 text-amber-500';
                document.getElementById('voltage-bar').style.backgroundColor = '#f59e0b';
            } else {
                document.getElementById('battery-status').textContent = 'Good';
                document.getElementById('battery-status').className = 'font-medium ml-1 text-green-500';
                document.getElementById('voltage-bar').style.backgroundColor = '#10b981';
            }
            
            // GPS updates
            const lat = 34.0522 + (Math.random() * 0.02 - 0.01);
            const lng = -118.2437 + (Math.random() * 0.02 - 0.01);
            document.getElementById('gps-coords').textContent = `${lat.toFixed(4)}° N, ${Math.abs(lng).toFixed(4)}° W`;
            
            // Update map marker if map is loaded
            if (window.marker) {
                const newPos = new google.maps.LatLng(lat, lng);
                window.marker.setPosition(newPos);
                window.map.panTo(newPos);
            }
            
            // Update GPS accuracy
            const accuracy = Math.floor(Math.random() * 20);
            document.getElementById('gps-accuracy').textContent = `Accuracy: ${accuracy}m`;
            
            // Update GPS speed
            const speed = Math.floor(Math.random() * 60);
            document.getElementById('gps-speed').textContent = `${speed} km/h`;
            
            // Update last updated time
            document.getElementById('gps-updated').textContent = 'Just now';
            
            // Update uptime
            setTimeout(simulateDataUpdates, 3000);
        }
        
        // Helper function to update sensor values with animation
        function updateSensorValue(elementId, newValue, color) {
            const element = document.getElementById(elementId);
            element.textContent = newValue;
            element.style.color = color;
            element.classList.add('data-updated');
            
            setTimeout(() => {
                element.classList.remove('data-updated');
            }, 1000);
        }
        
        // Start simulating data updates
        setTimeout(simulateDataUpdates, 1000);
    </script>
</body>
</html>